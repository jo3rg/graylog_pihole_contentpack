{
  "v": "1",
  "id": "475c7c8d-b3b7-46d6-86c3-135f19913045",
  "rev": 3,
  "name": "PiHole DnsMasq Content Pack",
  "summary": "Content Pack for Analyzing PiHole Logs",
  "description": "",
  "vendor": "jo3rg",
  "url": "https://github.com/jo3rg/graylog_pihole_contentpack",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "cde18c43-406b-459c-aac9-8606c2542201",
      "data": {
        "summary": {
          "@type": "string",
          "@value": ""
        },
        "search": {
          "queries": [
            {
              "id": "3d530542-d84d-4898-8cb3-2dff5ea9a7e5",
              "timerange": {
                "type": "relative",
                "from": 300
              },
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "query_action:blocked"
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "query_domain"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_domain",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "68098a5e-cb22-49ca-859b-979e0d5fc1db",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [],
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_answer_geolocation",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "95dc09b2-095c-4d89-aaf0-e803e14483cc",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "app_name:dnsmasq AND threat_indicated:true AND message:\"*query*\""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "threat_indicated"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "d477c477-8db2-46ed-b8fe-c08d93e40f65",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "app_name:dnsmasq AND message:\"*gravity blocked*\""
                  },
                  "name": "trend",
                  "timerange": {
                    "type": "offset",
                    "source": "search_type",
                    "id": "ed97b7ef-f3a0-4607-a1f2-88b1a1928a9a",
                    "offset": "1i"
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "app_name"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "e57b7dc5-6713-4f71-9e67-cf7061bbdf7b",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "app_name:dnsmasq AND threat_indicated:true AND message:\"*query*\""
                  },
                  "name": "trend",
                  "timerange": {
                    "type": "offset",
                    "source": "search_type",
                    "id": "d477c477-8db2-46ed-b8fe-c08d93e40f65",
                    "offset": "1i"
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "threat_indicated"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "458aecc6-ca85-43bb-a0c7-e0053248a4eb",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "app_name:dnsmasq"
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [],
                  "series": [
                    {
                      "type": "count",
                      "id": "count(timestamp)",
                      "field": "timestamp"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "field": "timestamp",
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "id": "7ee8e9c5-eafd-458e-96d9-dd06c03647ed",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "threat_indicated:true"
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "threat_names"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "threat_names",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "b90f4810-9ee5-4cf7-8b04-3dec1f716768",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "query_type: A OR AAAA"
                  },
                  "name": "trend",
                  "timerange": {
                    "type": "offset",
                    "source": "search_type",
                    "id": "c90b5097-dab1-40c7-b8b7-2ef0413b8f13",
                    "offset": "1i"
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "query_type"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "02986932-518c-4c9b-b8e8-44d22a096a5d",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "query_action"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_action",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "d6a91908-5643-4f11-92fd-ee4829b1cf78",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "app_name:dnsmasq AND message:\"*gravity blocked*\""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "app_name"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "ed97b7ef-f3a0-4607-a1f2-88b1a1928a9a",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "query_type: A OR AAAA"
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "query_type"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "id": "c90b5097-dab1-40c7-b8b7-2ef0413b8f13",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "query_source"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_source",
                      "limit": 10
                    }
                  ],
                  "type": "pivot",
                  "id": "69fc19f2-fea2-4b4d-8ec4-050fd796499b",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "threat_indicated:true"
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "query_domain"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_domain",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "b9390b22-cc35-49fe-a206-0512e3b80a2a",
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": null,
                  "name": null,
                  "timerange": null,
                  "offset": 0,
                  "streams": [],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "id": "4b31e69b-bd56-4431-968b-7edc38f64b24",
                  "limit": 150
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "type": "relative",
                    "from": 86400
                  },
                  "streams": [
                    "aa357940-251a-4c81-8f27-29f5841664b5"
                  ],
                  "series": [
                    {
                      "type": "count",
                      "id": "Count",
                      "field": "query_answer_whois_organization"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "field": "query_answer_whois_organization",
                      "limit": 15
                    }
                  ],
                  "type": "pivot",
                  "id": "6f1f4f00-1ff1-4b10-a752-a709a7a7139a",
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "joerg",
          "created_at": "2023-02-14T10:35:06.227Z"
        },
        "created_at": "2023-02-10T13:52:33.325Z",
        "requires": {},
        "state": {
          "3d530542-d84d-4898-8cb3-2dff5ea9a7e5": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "DNS Intel v2"
              },
              "widget": {
                "aff279ae-0c3f-482f-bc3d-c1fed786f4cb": "DNS Querys Timeline (24h)",
                "0ac847fd-1b66-4f20-85fa-2f674482ae35": "Threat indicated (24h)",
                "b239480c-8d28-4d5f-add7-187b3a726989": "Threat Names (24h)",
                "26fc0c16-d0f1-445e-b69c-1a8ab4740ca8": "DNS Clients (24h)",
                "98c972cc-f4fa-4c94-a54a-110fc0b87dd8": "Threat Specific Domains (24h)",
                "69c412d2-efb7-46e3-9b68-47a83b3ca87b": "PiHole Stream",
                "010cc0d8-6b27-4ae7-980a-373153c26a35": "Owning Companies (24h)",
                "cc34f847-12d0-4c99-9bc4-4dfda42f5761": "DNS Activities (24h)",
                "269b2b92-7feb-4b87-b80f-eb6387487e66": "Blocked Domains (24h)",
                "4e92b791-a20f-49fc-a846-65070a938c68": "DNS Querys (24h)",
                "8637a173-0121-45ae-8ab7-1170a4356e7a": "Blackholed Requests (24h)"
              }
            },
            "widgets": [
              {
                "id": "aff279ae-0c3f-482f-bc3d-c1fed786f4cb",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "app_name:dnsmasq"
                },
                "streams": [],
                "config": {
                  "visualization": "bar",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "timestamp",
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(timestamp)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "26fc0c16-d0f1-445e-b69c-1a8ab4740ca8",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_source",
                      "type": "values",
                      "config": {
                        "limit": 10
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(query_source)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "8637a173-0121-45ae-8ab7-1170a4356e7a",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "app_name:dnsmasq AND message:\"*gravity blocked*\""
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "numeric",
                  "event_annotation": false,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count(app_name)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "LOWER"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "0fbabff3-0bdf-44b3-9f8e-c5aeb6c3017e",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "streams": [],
                "config": {
                  "visualization": "map",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_answer_geolocation",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "viewport": {
                      "zoom": 1,
                      "center_x": 0,
                      "center_y": 0
                    }
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "0ac847fd-1b66-4f20-85fa-2f674482ae35",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "app_name:dnsmasq AND threat_indicated:true AND message:\"*query*\""
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "numeric",
                  "event_annotation": false,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count(threat_indicated)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "LOWER"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "98c972cc-f4fa-4c94-a54a-110fc0b87dd8",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "threat_indicated:true"
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_domain",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(query_domain)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "269b2b92-7feb-4b87-b80f-eb6387487e66",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "query_action:blocked"
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_domain",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(query_domain)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "010cc0d8-6b27-4ae7-980a-373153c26a35",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_answer_whois_organization",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(query_answer_whois_organization)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "b239480c-8d28-4d5f-add7-187b3a726989",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "threat_indicated:true"
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "threat_names",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(threat_names)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "4e92b791-a20f-49fc-a846-65070a938c68",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "query_type: A OR AAAA"
                },
                "streams": [
                  "aa357940-251a-4c81-8f27-29f5841664b5"
                ],
                "config": {
                  "visualization": "numeric",
                  "event_annotation": false,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count(query_type)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                }
              },
              {
                "id": "69c412d2-efb7-46e3-9b68-47a83b3ca87b",
                "type": "messages",
                "filter": null,
                "timerange": null,
                "query": null,
                "streams": [],
                "config": {
                  "fields": [
                    "timestamp",
                    "source"
                  ],
                  "show_message_row": true,
                  "show_summary": true,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                }
              },
              {
                "id": "cc34f847-12d0-4c99-9bc4-4dfda42f5761",
                "type": "aggregation",
                "filter": null,
                "timerange": {
                  "type": "relative",
                  "from": 86400
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "streams": [],
                "config": {
                  "visualization": "table",
                  "event_annotation": false,
                  "row_pivots": [
                    {
                      "field": "query_action",
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Count"
                      },
                      "function": "count(query_action)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                }
              }
            ],
            "widget_mapping": {
              "aff279ae-0c3f-482f-bc3d-c1fed786f4cb": [
                "7ee8e9c5-eafd-458e-96d9-dd06c03647ed"
              ],
              "0ac847fd-1b66-4f20-85fa-2f674482ae35": [
                "d477c477-8db2-46ed-b8fe-c08d93e40f65",
                "458aecc6-ca85-43bb-a0c7-e0053248a4eb"
              ],
              "b239480c-8d28-4d5f-add7-187b3a726989": [
                "b90f4810-9ee5-4cf7-8b04-3dec1f716768"
              ],
              "26fc0c16-d0f1-445e-b69c-1a8ab4740ca8": [
                "69fc19f2-fea2-4b4d-8ec4-050fd796499b"
              ],
              "98c972cc-f4fa-4c94-a54a-110fc0b87dd8": [
                "b9390b22-cc35-49fe-a206-0512e3b80a2a"
              ],
              "69c412d2-efb7-46e3-9b68-47a83b3ca87b": [
                "4b31e69b-bd56-4431-968b-7edc38f64b24"
              ],
              "010cc0d8-6b27-4ae7-980a-373153c26a35": [
                "6f1f4f00-1ff1-4b10-a752-a709a7a7139a"
              ],
              "cc34f847-12d0-4c99-9bc4-4dfda42f5761": [
                "d6a91908-5643-4f11-92fd-ee4829b1cf78"
              ],
              "0fbabff3-0bdf-44b3-9f8e-c5aeb6c3017e": [
                "95dc09b2-095c-4d89-aaf0-e803e14483cc"
              ],
              "269b2b92-7feb-4b87-b80f-eb6387487e66": [
                "68098a5e-cb22-49ca-859b-979e0d5fc1db"
              ],
              "4e92b791-a20f-49fc-a846-65070a938c68": [
                "c90b5097-dab1-40c7-b8b7-2ef0413b8f13",
                "02986932-518c-4c9b-b8e8-44d22a096a5d"
              ],
              "8637a173-0121-45ae-8ab7-1170a4356e7a": [
                "e57b7dc5-6713-4f71-9e67-cf7061bbdf7b",
                "ed97b7ef-f3a0-4607-a1f2-88b1a1928a9a"
              ]
            },
            "positions": {
              "aff279ae-0c3f-482f-bc3d-c1fed786f4cb": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": 11
              },
              "0ac847fd-1b66-4f20-85fa-2f674482ae35": {
                "col": 5,
                "row": 3,
                "height": 3,
                "width": 2
              },
              "b239480c-8d28-4d5f-add7-187b3a726989": {
                "col": 5,
                "row": 10,
                "height": 3,
                "width": 4
              },
              "26fc0c16-d0f1-445e-b69c-1a8ab4740ca8": {
                "col": 1,
                "row": 10,
                "height": 3,
                "width": 4
              },
              "98c972cc-f4fa-4c94-a54a-110fc0b87dd8": {
                "col": 9,
                "row": 10,
                "height": 3,
                "width": 3
              },
              "69c412d2-efb7-46e3-9b68-47a83b3ca87b": {
                "col": 1,
                "row": 13,
                "height": 5,
                "width": 11
              },
              "010cc0d8-6b27-4ae7-980a-373153c26a35": {
                "col": 9,
                "row": 6,
                "height": 4,
                "width": 3
              },
              "cc34f847-12d0-4c99-9bc4-4dfda42f5761": {
                "col": 9,
                "row": 3,
                "height": 3,
                "width": 3
              },
              "0fbabff3-0bdf-44b3-9f8e-c5aeb6c3017e": {
                "col": 1,
                "row": 6,
                "height": 4,
                "width": 5
              },
              "269b2b92-7feb-4b87-b80f-eb6387487e66": {
                "col": 6,
                "row": 6,
                "height": 4,
                "width": 3
              },
              "4e92b791-a20f-49fc-a846-65070a938c68": {
                "col": 1,
                "row": 3,
                "height": 3,
                "width": 4
              },
              "8637a173-0121-45ae-8ab7-1170a4356e7a": {
                "col": 7,
                "row": 3,
                "height": 3,
                "width": 2
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "joerg",
        "title": {
          "@type": "string",
          "@value": "DNS Intel v2"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "6dfa2162-02b0-4d4e-aff8-74de85b5f911",
      "data": {
        "name": "PIHOLE5",
        "pattern": "%{WORD:programname}\\[%{POSINT:procid}\\]: %{NOTSPACE:query_list} %{NOTSPACE:query_domain} is %{NOTSPACE:query_answer}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "e96d8fe0-e22f-420c-ab14-c9dfdd5a087a",
      "data": {
        "name": "DNSMASQ",
        "pattern": "%{WORD:programname}\\[%{POSINT:procid}\\]:\\s(gravity\\s%{WORD:query_action}|%{WORD:query_action})(?:\\[%{WORD:query_type}\\]|%{SPACE})?\\s%{NOTSPACE:query_domain}\\s(?:from %{NOTSPACE:query_source}|is %{IP:query_answer}|to %{NOTSPACE:query_target})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "f5c6c5ff-fa9d-4cc6-b356-bdd25ffbcf8b",
      "data": {
        "name": "NOTSPACE",
        "pattern": "\\S+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "3371b880-6f37-448f-b163-6000e7554313",
      "data": {
        "name": "WORD",
        "pattern": "\\b\\w+\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "fc97f7d0-7714-4bf1-9d73-f181e44f56a2",
      "data": {
        "name": "IPV6",
        "pattern": "((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "bf7ddd6b-21e0-4921-aca3-0ef9eb2d2bde",
      "data": {
        "name": "IPV4",
        "pattern": "(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "010d4378-e3bd-4f15-acca-cf813e5151e0",
      "data": {
        "name": "POSINT",
        "pattern": "\\b(?:[1-9][0-9]*)\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "508a6792-8f47-400e-9de7-9923e9672a76",
      "data": {
        "name": "SPACE",
        "pattern": "\\s*"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "dffb9bb5-1398-424d-b566-f08f18d50e11",
      "data": {
        "name": "IP",
        "pattern": "(?:%{IPV6}|%{IPV4})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "97d9f9b4-d578-442c-aa9a-654497da44f5",
      "data": {
        "title": {
          "@type": "string",
          "@value": "piHole Syslog"
        },
        "configuration": {
          "port": {
            "@type": "integer",
            "@value": 1515
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "override_source": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 4
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": ""
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "grok_pattern": {
                "@type": "string",
                "@value": "%{NOTSPACE} %{NOTSPACE:app_name}\\[.*\\]: "
              },
              "named_captures_only": {
                "@type": "boolean",
                "@value": true
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "PiHole app_name"
            },
            "type": {
              "@type": "string",
              "@value": "GROK"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          },
          {
            "target_field": {
              "@type": "string",
              "@value": ""
            },
            "condition_value": {
              "@type": "string",
              "@value": ""
            },
            "order": {
              "@type": "integer",
              "@value": 1
            },
            "converters": [],
            "configuration": {
              "grok_pattern": {
                "@type": "string",
                "@value": "%{NOTSPACE} %{NOTSPACE:app_name}\\[.*\\]: (?:query\\[%{WORD:query_type}\\]|%{WORD:query_action}) %{NOTSPACE:query_domain} (?:is (%{IPV4:query_answer}|%{IPV6:query_answer})|from (%{IPV4:query_source}|%{IPV6:query_source})|to (%{IPV4:query_target}|%{IPV6:query_target}))"
              },
              "named_captures_only": {
                "@type": "boolean",
                "@value": true
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "PiHole Query"
            },
            "type": {
              "@type": "string",
              "@value": "GROK"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "NONE"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "52f6144d-526f-40da-977d-31ae035f54a5",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geolite2-city"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/usr/share/graylog/data/GeoLite2-City.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_CITY"
          },
          "check_interval": {
            "@type": "long",
            "@value": 0
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "b1403caa-0c4b-4179-9c91-14cc26c50a9e",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geolite2-city"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 60
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "7f9c3d8a-da2f-4b2e-bcf7-fa88c4addafb",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "b1403caa-0c4b-4179-9c91-14cc26c50a9e"
        },
        "name": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "52f6144d-526f-40da-977d-31ae035f54a5"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "20125f94-0998-46a2-93cf-d6f07d4dc835",
      "data": {
        "title": {
          "@type": "string",
          "@value": "pihole / dnsmasq"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"pihole / dnsmasq\"\nstage -1 match either\nrule \"dnsmasq split\"\nrule \"dnsmasq pihole list\"\nstage 0 match either\nrule \"PiHole GeoIP Set\"\nstage 1 match either\nrule \"threatintel (dnsmasq pihole)\"\nrule \"threatintel (2) inflate\"\nrule \"dnsmasq clean message\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "aa357940-251a-4c81-8f27-29f5841664b5"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7d9c9077-da58-48bd-b00d-959fbe51be23",
      "data": {
        "title": {
          "@type": "string",
          "@value": "threatintel (dnsmasq pihole)"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"threatintel (dnsmasq pihole)\"\nwhen\n    has_field(\"query_answer\") OR has_field(\"query_domain\")\nthen\n\n  // Read the README!!\n  // https://github.com/Graylog2/graylog-plugin-threatintel\n\n  // first look up the IP that is in query_answer\n  let query_answer_intel = threat_intel_lookup_ip(to_string($message.query_answer), \"query_answer\");\n  set_fields(query_answer_intel);\n  \n  // look up DNS Requested Domain or Domain that is in response\n  let query_domain_intel = threat_intel_lookup_domain(to_string($message.query_domain), \"query_domain\");\n  set_fields(query_domain_intel);\n  \n  let whois_intel = whois_lookup_ip(to_string($message.query_answer), \"query_answer\");\n  set_fields(whois_intel);\n  \n  let intel = otx_lookup_ip(to_string($message.query_answer));\n  let intel = otx_lookup_domain(to_string($message.query_domain));\n  \n  //set_field(\"threat_indicated\", intel.otx_threat_indicated);\n  set_field(\"threat_ids\", intel.otx_threat_ids);\n  set_field(\"threat_names\", intel.otx_threat_names);\n  \n  // integrate abusech lookups\n  let intelabuse = abusech_ransom_lookup_ip(to_string($message.query_answer));\n  let intelabuse = abusech_ransom_lookup_domain(to_string($message.query_domain));\n  \n  //set_field ()\n  set_field(\"abuse_threat_indicated\", intelabuse.threat_indicated);\n  \n  // set debug mark\n  set_field(\"pipeline\", \"threatintel (dnsmasq pihole)\" );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ddec3d96-dbba-46e7-ab80-e270a81d52c7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "dnsmasq pihole list"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"dnsmasq pihole list\"\nwhen\n    has_field(\"application_name\") AND contains(to_string($message.application_name), \"dnsmasq\")\nthen\n let message_field = to_string($message.message); \n\n // pihole GROK Pattern neeed to be present!\n // %{SYSLOGTIMESTAMP:query_timestamp} %{WORD: programname}\\[%{POSINT:procid}\\]: %{NOTSPACE:query_list} %{NOTSPACE:query_domain} is %{NOTSPACE:query_answer}\n\n let action = grok(pattern: \"%{PIHOLE5}\", value: message_field, only_named_captures: true);\n set_fields(action);\n set_field(\"pipeline\", \"dnsmasq pihole list\");\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fd62306e-4171-4c67-b6d1-72c4e3b5c2fd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "threatintel (2) inflate"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"threatintel (2) inflate\"\nwhen\n  to_bool($message.query_answer_threat_indicated) OR to_bool($message.query_domain_threat_indicated)\nthen\n  set_field(\"threat_indicated\", true);\n  // set debug mark\n  set_field(\"pipeline\", \"threatintel (2)\" );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "bcc38b3a-5f5b-4918-8851-e60ae1cde68a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "dnsmasq clean message"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"dnsmasq clean message\"\nwhen\n     has_field(\"programname\") AND contains(to_string($message.programname), \"dnsmasq\")\nthen\n   let m = regex(\"^.+: (.+)$\", to_string($message.message));\n   let clean_message = m[\"0\"];\n  // Set a better message field without the prefix clutter.\n  set_field(\"message\", clean_message);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5e61ab83-0694-4d19-a98a-2362cf1a4604",
      "data": {
        "title": {
          "@type": "string",
          "@value": "PiHole GeoIP Set"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"PiHole GeoIP Set\"\nwhen\n    has_field(\"query_answer\") &&  \n    ! cidr_match(\"10.0.0.0/8\", to_ip($message.query_answer)) ||\n    ! cidr_match(\"172.16.0.0/12\", to_ip($message.query_answer)) ||\n    ! cidr_match(\"192.168.0.0/16\", to_ip($message.query_answer))\nthen\n    let geo = lookup(\"GeoLite2-City\",to_string($message.query_answer));\n    set_field(\"query_answer_geolocation\", geo[\"coordinates\"]);\n    set_field(\"query_answer_country_code\", geo[\"country\"].iso_code);\n    set_field(\"query_answer_country_name\", geo[\"country\"].names.en);\n    set_field(\"query_answer_city_name\", geo[\"city\"].names.en);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "bb84d9bb-91f2-4fc1-9359-3e4dcdfe509e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "dnsmasq split"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"dnsmasq split\"\nwhen\n    has_field(\"app_name\") AND contains(to_string($message.app_name), \"dnsmasq\")\nthen\n let message_field = to_string($message.message); \n\n // DNSMASQ GROK Pattern neeed to be present!\n // %{SYSLOGTIMESTAMP:query_timestamp} %{WORD: programname}\\[%{POSINT:procid}\\]: %{WORD:query_action}(?:\\[%{WORD:query_type}\\]|%{SPACE}) %{NOTSPACE:query_domain} (?:from %{NOTSPACE:query_source}|is %{NOTSPACE:query_answer}|to %{NOTSPACE:query_target})\n \n\n let action = grok(pattern: \"%{DNSMASQ}\", value: message_field, only_named_captures: true);\n set_fields(action);\n set_field(\"pipeline\", \"dnsmasq split\");\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "aa357940-251a-4c81-8f27-29f5841664b5",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Pihole Stream"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "app_name"
            },
            "value": {
              "@type": "string",
              "@value": "dnsmasq"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Messages from PiHole"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.3.11+b48cf45"
        }
      ]
    }
  ]
}